## 融资项目利率分布

## 思路

	 1、获取所有融资的利率
	 2、根据利率分布标准，分类 ,标准未定？

select 		
	p.RATE_PY ,
	count(1) as rate_py_num
	from sp_investing i, sp_invest_project p
where 1=1
	and i.project_no = p.PROJECT_NO
	and i.status in (1,2)
	and p.STATUS in (1,2,3,4)
    and p.project_type in (0,4,5)
	and p.project_no not in (select project_no from sp_project_tag where tag=0)
	
	group by p.RATE_PY
	

<——start——>


SELECT
	p.rate_py, 	
	COUNT(DISTINCT p.project_no)
FROM 	 
	sp_invest_project p
LEFT JOIN 
	(
	SELECT project_no, min(payed_on) AS payed_on
	From sp_loan_pay
	GROUP BY project_no
	) l
ON l.project_no = p.project_no
WHERE 1=1 
	AND p.project_no not in (SELECT project_no FROM sp_project_tag WHERE tag = 0)
	AND p.project_type in (0,4,5)
	AND p.status in (3,4)
	AND l.payed_on < @end_time
GROUP BY p.rate_py;


<——end——>